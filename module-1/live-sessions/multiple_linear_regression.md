Live session 1.1: Multiple linear regression
================
Matthew Ragoza
1/14/2022

-   [Read in the data.](#read-in-the-data.)
-   [Fit the linear regression
    model.](#fit-the-linear-regression-model.)
-   [Display the ANOVA table.](#display-the-anova-table.)
-   [Compute predicted values.](#compute-predicted-values.)
-   [Compare three linear regression
    models.](#compare-three-linear-regression-models.)
-   [Fit a model on centered data.](#fit-a-model-on-centered-data.)
-   [Compare predicted values.](#compare-predicted-values.)
-   [Predict values for new data.](#predict-values-for-new-data.)

## Read in the data.

``` r
setwd('C:\\Users\\mtr22\\Code\\BIOST2049\\live-session-1-1')
data <- read.csv('Module1Topics1and2Example.csv')
data
```

    ##    patient  y   x1  x2      x3
    ## 1        1 44 2.80 6.1 25.1403
    ## 2        2 25 3.10 5.1  8.9272
    ## 3        3 10 2.59 6.0 10.1257
    ## 4        4 28 3.36 6.9 15.9265
    ## 5        5 25 2.80 7.0 19.2332
    ## 6        6 72 3.35 5.6 30.2405
    ## 7        7 45 2.99 6.3 20.1400
    ## 8        8 25 2.99 7.2 13.6453
    ## 9        9 12 2.92 6.9 26.3007
    ## 10      10 24 3.23 6.5 13.6673
    ## 11      11 46 3.37 6.8 28.9715
    ## 12      12  8 2.72 6.6  5.8435
    ## 13      13 15 3.47 8.4 24.3737
    ## 14      14 28 2.70 5.9 14.8633
    ## 15      15 26 3.24 6.0  1.4689
    ## 16      16 27 2.65 6.0 30.6508
    ## 17      17  4 3.41 7.6 29.4623
    ## 18      18 14 2.58 6.2  4.0142
    ## 19      19 21 2.81 6.0  3.7338
    ## 20      20 22 2.80 6.4  0.8318
    ## 21      21 60 3.62 6.8 29.2211
    ## 22      22 10 2.74 8.4 13.5363
    ## 23      23 60 3.27 6.7 31.4858
    ## 24      24 12 3.78 8.3 16.3840
    ## 25      25 28 2.90 5.6 25.8718
    ## 26      26 39 3.70 7.3 23.1540
    ## 27      27 14 3.40 7.0 10.9666
    ## 28      28  8 2.63 6.9 30.7112
    ## 29      29 11 2.65 5.8 20.6121
    ## 30      30  7 3.26 7.2  6.1769
    ## 31      31 23 3.15 6.5 21.7526
    ## 32      32 16 2.60 6.3  1.5134
    ## 33      33 26 2.74 6.8  4.8115
    ## 34      34  8 2.72 5.9 25.8010
    ## 35      35 11 3.11 6.8 26.2402
    ## 36      36 12 2.79 6.7 12.6817
    ## 37      37 50 2.90 6.7 15.9655
    ## 38      38  9 2.74 5.5 29.8701
    ## 39      39 13 2.70 6.9 21.0572
    ## 40      40 22 3.08 6.3 26.5404
    ## 41      41 23 2.18 6.1  4.1312
    ## 42      42 31 2.88 5.8 13.9093
    ## 43      43 20 3.04 6.8 13.3078
    ## 44      44 65 3.32 7.3 27.1748
    ## 45      45  9 2.80 5.9 27.3041
    ## 46      46 12 3.29 6.8  5.9955
    ## 47      47 21 3.56 8.8 20.3611
    ## 48      48 13 2.74 7.1  3.5860
    ## 49      49 10 3.06 6.9 24.2661
    ## 50      50  4 2.54 6.7 25.9945
    ## 51      51 18 2.78 7.2  2.0933
    ## 52      52 10 2.81 5.2 16.7182
    ## 53      53  7 3.26 6.6 28.9761

## Fit the linear regression model.

``` r
model <- lm(y ~ x1 + x2, data=data)
summary(model)
```

    ## 
    ## Call:
    ## lm(formula = y ~ x1 + x2, data = data)
    ## 
    ## Residuals:
    ##     Min      1Q  Median      3Q     Max 
    ## -22.137  -9.490  -2.019   6.438  39.407 
    ## 
    ## Coefficients:
    ##             Estimate Std. Error t value Pr(>|t|)   
    ## (Intercept)  -0.6354    20.9683  -0.030  0.97595   
    ## x1           23.4514     6.8385   3.429  0.00122 **
    ## x2           -7.0726     3.0109  -2.349  0.02282 * 
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 14.86 on 50 degrees of freedom
    ## Multiple R-squared:  0.1997, Adjusted R-squared:  0.1677 
    ## F-statistic: 6.238 on 2 and 50 DF,  p-value: 0.003815

## Display the ANOVA table.

``` r
anova(model)
```

    ## Analysis of Variance Table
    ## 
    ## Response: y
    ##           Df  Sum Sq Mean Sq F value  Pr(>F)  
    ## x1         1  1535.9 1535.86  6.9576 0.01109 *
    ## x2         1  1218.0 1218.01  5.5177 0.02282 *
    ## Residuals 50 11037.3  220.75                  
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

## Compute predicted values.

``` r
data$yhat <- predict(model)
data$yhat
```

    ##  [1] 21.885752 35.993791 17.668210 29.360466 15.520403 38.320346 24.927002
    ##  [8] 18.561656 19.041838 29.140827 30.302240 16.473334 21.331216 20.955131
    ## [15] 32.911646 19.075300 25.582217 16.019175 22.827526 19.763968 36.165099
    ## [22]  4.211667 28.664363 29.308417 27.767204 34.504913 29.591268 12.240923
    ## [29] 20.489821 24.893544 27.264714 15.780940 15.527838 21.424159 24.204867
    ## [36] 17.407673 19.987334 24.722232 13.882522 27.037630  7.345864 25.883651
    ## [43] 22.563268 25.593365 23.300272 28.426127 20.612796 13.406058 22.325036
    ## [50] 11.544814 13.636854 28.485615 29.137109

## Compare three linear regression models.

``` r
model1 <- lm(y ~ x1, data=data)
model2 <- lm(y ~ x2, data=data)
model3 <- lm(y ~ x1 + x2, data=data)
c(
    summary(model1)$r.squared,
    summary(model2)$r.squared,
    summary(model3)$r.squared
)
```

    ## [1] 0.11136523 0.01144553 0.19968365

## Fit a model on centered data.

``` r
data$x1_c <- scale(data$x1, center=TRUE, scale=FALSE)
data$x2_c <- scale(data$x2, center=TRUE, scale=FALSE)
model_c <- lm(y ~ x1_c + x2_c, data=data)
summary(model_c)
```

    ## 
    ## Call:
    ## lm(formula = y ~ x1_c + x2_c, data = data)
    ## 
    ## Residuals:
    ##     Min      1Q  Median      3Q     Max 
    ## -22.137  -9.490  -2.019   6.438  39.407 
    ## 
    ## Coefficients:
    ##             Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)   22.698      2.041  11.122 3.98e-15 ***
    ## x1_c          23.451      6.839   3.429  0.00122 ** 
    ## x2_c          -7.073      3.011  -2.349  0.02282 *  
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 14.86 on 50 degrees of freedom
    ## Multiple R-squared:  0.1997, Adjusted R-squared:  0.1677 
    ## F-statistic: 6.238 on 2 and 50 DF,  p-value: 0.003815

## Compare predicted values.

``` r
data$yhat_c <- predict(model_c)
data[c('yhat', 'yhat_c')]
```

    ##         yhat    yhat_c
    ## 1  21.885752 21.885752
    ## 2  35.993791 35.993791
    ## 3  17.668210 17.668210
    ## 4  29.360466 29.360466
    ## 5  15.520403 15.520403
    ## 6  38.320346 38.320346
    ## 7  24.927002 24.927002
    ## 8  18.561656 18.561656
    ## 9  19.041838 19.041838
    ## 10 29.140827 29.140827
    ## 11 30.302240 30.302240
    ## 12 16.473334 16.473334
    ## 13 21.331216 21.331216
    ## 14 20.955131 20.955131
    ## 15 32.911646 32.911646
    ## 16 19.075300 19.075300
    ## 17 25.582217 25.582217
    ## 18 16.019175 16.019175
    ## 19 22.827526 22.827526
    ## 20 19.763968 19.763968
    ## 21 36.165099 36.165099
    ## 22  4.211667  4.211667
    ## 23 28.664363 28.664363
    ## 24 29.308417 29.308417
    ## 25 27.767204 27.767204
    ## 26 34.504913 34.504913
    ## 27 29.591268 29.591268
    ## 28 12.240923 12.240923
    ## 29 20.489821 20.489821
    ## 30 24.893544 24.893544
    ## 31 27.264714 27.264714
    ## 32 15.780940 15.780940
    ## 33 15.527838 15.527838
    ## 34 21.424159 21.424159
    ## 35 24.204867 24.204867
    ## 36 17.407673 17.407673
    ## 37 19.987334 19.987334
    ## 38 24.722232 24.722232
    ## 39 13.882522 13.882522
    ## 40 27.037630 27.037630
    ## 41  7.345864  7.345864
    ## 42 25.883651 25.883651
    ## 43 22.563268 22.563268
    ## 44 25.593365 25.593365
    ## 45 23.300272 23.300272
    ## 46 28.426127 28.426127
    ## 47 20.612796 20.612796
    ## 48 13.406058 13.406058
    ## 49 22.325036 22.325036
    ## 50 11.544814 11.544814
    ## 51 13.636854 13.636854
    ## 52 28.485615 28.485615
    ## 53 29.137109 29.137109

## Predict values for new data.

``` r
newdata <- data.frame(x1=2.8, x2=7)
newdata$yhat <- predict(model, newdata)
newdata
```

    ##    x1 x2    yhat
    ## 1 2.8  7 15.5204
